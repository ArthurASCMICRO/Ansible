---
- name: Installer VLC via winget (commande minimale fonctionnelle)
  hosts: all
  gather_facts: no

  tasks:
    - name: Vérifier winget
      ansible.windows.win_command: winget --version
      changed_when: false

    - name: Installer ou mettre à jour VLC (mode minimal)
      ansible.windows.win_command: >
        winget install vlc
        --accept-source-agreements
      register: vlc_install
      changed_when: "'Installé correctement' in vlc_install.stdout or 'mise à niveau' in vlc_install.stdout"
      failed_when: false

    - name: DEBUG résultat VLC
      ansible.builtin.debug:
        msg:
          - "rc={{ vlc_install.rc }}"
          - "{{ vlc_install.stdout }}"
