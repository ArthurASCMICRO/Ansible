- name: Test désinstallation VLC via winget
  hosts: all
  gather_facts: no

  tasks:
    - name: Vérifier la présence de winget
      ansible.windows.win_command: winget --version
      register: winget_check
      changed_when: false
      failed_when: winget_check.rc != 0

    - name: Désinstaller VLC
      ansible.windows.win_command: >
        winget uninstall --id VideoLAN.VLC
        --exact
        --silent
      register: vlc_uninstall
      changed_when: "'Successfully uninstalled' in vlc_uninstall.stdout"
